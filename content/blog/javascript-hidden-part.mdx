---
title: read javascript the hidden part
date: "2023-07-13"
description: the secret
image: /images/blog/flower-girl.jpg
authors:
  - KUD
---

我们经常继承那些已经成长并演变成难以管理的项目。作为参与该项目开发人员之一，您有权对现有代码组织进行更改。你应该有信心向团队中的其他人提出任何问题或关注，并让大家达成共识，明确今后的做法以及如何处理技术债务。

good README:
- How to start the project
- File/folder conventions
- How to handle common issues

create folder structure: 设置一个地方来存放模板文件，这样你就可以在不同的文件夹中复制和粘贴。这样开发人员每次需要新建文件时就不必从头开始了

```text
|__client
|____components
|____helpers(or utils)
|__server
|____models
|____crons
```

在前端，我们使用帕斯卡命名法来命名文件，而在后端我们使用驼峰命名法。这只是为了向您展示，在整个技术栈中可以遵循不同的约定。

在组件和传递属性方面，Angular比React更加具体化

在后端方面，您可能更关注用户对应用程序中可访问数据的身份验证和授权方式以及如何获取和传输该数据到各个地方。

backend:
- REST API
- microservices
- graphQL

microservices

```text
|__api
|____users
|______getUserProfile.ts
|______updateUserProfile.ts
|______userProfiles.ts
```
GraphQL 相对较新，并且你将看到它被广泛使用的方式也会各不相同。当需要在前端显示复杂数据结构时，通常会使用它。尽管您可能还会看到它被用来替代 REST API。

GraphQL 由类型、模式、查询和突变组成，因此项目结构可以非常扁平化

```text
|__src
|____resolvers
|______users.ts
|______accounts.ts
|______products.ts
|____types
|______users.sdl.ts
|______accounts.sdl.ts
|______products.sdl.ts
```
所有与数据库中的数据交互的查询和变更将存储在resolvers文件夹下，并且解析器的类型定义将在types文件夹中定义。您可能会使用Apollo来构建这种类型的后端，它是业界标准工具，并且对项目结构有一些意见，这将极大地影响您放置文件的位置。

根据您正在开发的应用程序类型，需要关注不同功能。某些应用程序必须遵守HIPAA或PCI等法规要求，这可能会影响很多开发决策。数据管理方式也会影响代码选择方式。

Fin-tech

One good strategy is to focus on component-driven development on the front-end. This applies to any app you build, regardless of the functionality. It helps keep data-heavy components in a reusable and testable state that you can build more complex views on top of.

components are the building blocks for views, which are specific sections of pages.
```text
|__src
|____tests
|______LoginModal_test.ts
|______AdminAuth_test.ts
|______UserAuth_test.ts
|____components
|______LoginModal.ts
|______AdminAuth.ts
|______UserAuth.ts
|______FilterDropdown.ts
|______SearchInput.ts
|______Form.ts
|____pages
|______Accounts.ts
|______Settings.ts
|______Tools.ts
|____views
|______AccountActivity.ts
|______AccountInfo.ts
|______AccountStatements.ts
|______AccountSettings.ts
|______UserSettings.ts
|______AdminSettings.ts
|______BudgetTool.ts
|______PaymentTool.ts

|__api
|____db
|______userModel.ts
|______accountModel.ts
|______settingsModel.ts
|____repositories
|______users.ts
|______accounts.ts
|______settings.ts
|____utils
|______logger.ts
|______helpers.ts
|____services
|______auth.ts
|______email.ts
|______caching.ts
|____tests
|____routes.ts
```
TODO: need more deep reading

开发人员常犯的一个错误就是在完全理解问题所在之前就急于编写代码。在我职业生涯早期，我会被分配任务后立即开始编码。然后到了某个时候，我不知道下一步该往哪个方向走了。

如果当时停下来问一些背景问题、勾画出一些草图，并花时间去弄清楚细节，那将为我节省了大量重构时间和挫败感。

如果你的公司没有一个强大的产品团队或设计师，你可能需要通过提问来填补这个空白。在初创企业中，这种情况经常发生

尽早推动可访问性和响应式。对于视力障碍者、听力障碍者以及神经发育异常人群来说，可访问性至关重要。每个人都会说“我们稍后再回头处理”，但除非出现巨大问题，否则几乎永远不会发生。但是，在许多国家中，实际上要求遵守无障碍法规，并且响应能够吸引用户返回使用该应用程序。希望通过向产品经理和团队解释这一点，您可以获得额外时间来实施诸如WAI-ARIA用于可访问导航以及在多种设备上进行响应等功能。

继承一个现有的代码库。在了解项目组织和功能方式之后，你应该开始寻找技术债务。技术债务包括
- 更新软件包
- 清理过时的代码以符合最佳实践
- 重新组织代码以适应新产品需求

即使你没有时间在推出新功能时进行修复，也没关系。保持一个记录问题的文档，并确保向团队成员和利益相关者传达这些问题

根据自己的意愿更新代码库，尤其是如果没有其他人有强烈意见。即使他们有意见，在此过程中也是了解项目工作方式以及获取一些关于思考过程反馈的好机会。看到其他开发人员如何处理技术债务问题总是很有趣，因为他们能给出一些你可能没有考虑到的见解

对于项目后端而言，存在一组核心问题需要考虑：安全性、授权、性能、与数据库交互、与多个第三方服务合作以及处理任务队列等等。根据项目类型不同，还可能需要考虑消息队列、缓存或处理大量数据的问题。

如果最大关注点是速度，则可以考虑像Go这样的语言。如果您需要大量可导入库和包，请选择Python、JavaScript或Ruby等语言。如果您正在开发游戏特定应用程序，则C#可能是一个很好的选择。

写文档是任何项目中都会出现的另一个隐藏任务

通过模块化，您可以快速确定哪些响应需要不同级别的授权，以及哪些响应需要传递大量数据负载，从而确定是否将数据缓存是一个好选择。编写实施计划的草稿代码将迅速显示出技术上的差距所在。在编写了关于功能如何运作的文档后，您可以开始填充细节。

这将给您一个机会去研究可用的工具和服务，比如Redis用于缓存、OAuth标准用于不同身份验证/授权需求以及Sentry用于日志记录。另外一个很少有人谈论到的隐藏事实是，在处理复杂功能（例如缓存、处理消息队列甚至支付系统）时使用工具和服务是可以接受的。

除非您正在开发提供其中一项服务的应用程序，否则预期您使用某种替代方案而不是试图自行构建它。这就是为什么拥有代码概要非常重要。过早深入任何细节可能导致您被锁定在特定供应商或严格架构中，并且即使随着时间推移变得越来越复杂也必须遵循。

working on a existed backend:
- 为其他应用程序消费创建一个新版本的API
- 添加新包以清理到处都是的自定义混乱代码
- 增加更多测试覆盖率以减少生产环境中出现的错误

在现有的后端中，安全性是你应该考虑的首要问题之一。JavaScript Web Tokens (JWT) 是否只包含了最少量的必要信息？是否有些数据应该限制为仅供具备相应权限的个人用户或用户组使用？你是否发现了任何可能被OWASP十大漏洞（开发者和Web应用程序安全标准意识文件）所利用的潜在风险？外部人员通过你的API能否轻易找到内部资源？恶意用户是否可以通过请求过多数据来对你的应用进行分布式拒绝服务（DDOS）攻击？

在快速进行了一次安全审计之后，开始关注数据如何被使用。如果你知道特定端点将会收到很多请求，那么如何优化该端点以避免成为用户瓶颈呢？是否有一些计算可以转移到数据库并通过视图(view)而不是表格(table)提供给后端？是否可以将某些功能拆分到一个单独的端点上更好地实现？围绕数据改进性能对公司来说可能是巨大胜利，因为每个人都喜欢尽快获得所需的内容。

选择使用NoSQL数据库可能有以下几个原因：
- 需要存储大量数据
- 具有结构化和半结构化数据的组合
- 与微服务后端一起工作
- 需要可扩展架构

most commonly used types of NoSQL databases are: document, graph, wide-column, and key-value

SQL数据库, 当你被要求开发一个功能时，首先需要查看数据需求。检查以下内容：
- 新的下拉菜单或输入
- 用户权限级别的变化
- 页面之间的新连接
- 新的第三方集成

数据库架构在创建后并不是一成不变的，它会像代码一样随着时间的推移而增长和演变。

通常情况下，你不需要担心数据库基础设施部分，这就是DBA（数据库管理员）负责的工作，他们可能只是DevOps团队的成员之一。只要你能够连接到不同环境中的数据库，在云端如何提供服务由另一个团队处理。

数据库层面上还有很多改进措施可以加快响应速度。有时候DBA会在数据库中处理计算，并将值存储在视图中，因为作为开发人员你注意到从许多不同表格中获取值会减慢响应时间。这个隐藏于开发过程中的部分是你可能不会自己去云服务提供商那里更新资源，但你将与负责此项工作的人密切合作。

检查的事项：
- 确保数据库服务器具备足够的资源。在CPU、内存、磁盘空间和分配预算之间找到一个良好的平衡。
- 尝试对数据建立索引。这将涉及创建新表作为表之间关系的索引，可以使查询比在必要时遍历所有数据更简单和更快。
- 查看数据库连接池。配置可能需要更新以处理更多活动连接。
- 看看是否有任何查询可以编写成SQL语句而不是循环。
- 考虑进行一些数据碎片整理。它有助于清理删除和插入新数据后留下的一些空闲空间。

数据库扩展方法(scale)。
- 一种常见的做法是将数据进行分片。分片意味着将数据拆分为较小的子集，然后将它们分布到许多不同的数据库服务器上。这些服务器会物理上隔离，因此连接字符串需要更新，并且您需要特别注意访问正确的服务器。
- 另一种处理扩展问题的策略是对数据库进行分区。这与分片类似，只是所有数据都保留在同一台服务器上。它只允许以更细粒度地方式访问被划分成较小部分的数据。

---

实施了日志记录的公司通常能够更快地找到问题的根本原因。以易于访问的方式记录错误和警告对于应用程序在用户使用过程中的整体健康非常重要。

记录对数据所做的任何更改。当您试图确定何时进行了更改以及谁进行了更改时，这将非常有价值。当您处理受HIPAA或PCI-DSS等合规要求保护的数据时，它也非常重要，并且还有助于定期安全预防措施。

什么是HIPAA？

HIPAA代表《医疗保险可携带性与责任法案》（Health Insurance Portability and Accountability Act）。这是一项联邦法律，要求制定国家标准以保护敏感患者健康信息不被未经同意地披露。

什么是PCI-DSS？

PCI-DSS代表《支付卡行业数据安全标准》（Payment Card Industry Data Security Standard）。这是一个信息安全标准，适用于处理来自Visa、MasterCard和Discover等主要信用卡方案的公司。

事件记录是最容易被忽视的一种记录类型。事件可以是用户进行的任何类型活动：按钮点击、页面浏览或其他操作。对于要记录哪些事件并没有真正限制或定义。通过记录，您可以获得关于用户如何与您所开发应用程序互动方面令人难以置信的业务洞察力，并且大多数情况下，通过有针对性地记录，您可以回答大部分业务问题。

例如，您可以看到客户放弃购物车时刻、他们预约可能会选择哪个时间段以及根据GPS坐标确定他们确切位置等信息。从记录用户活动中获取到的数据通常是无法直接从用户那里获取到的。

---

每次向API发送请求时，都应该进行日志记录。这有助于您了解何时升级资源以处理流量增加，并有助于保持API的安全性。您可以设置警报以检测可疑活动，并查看哪些端点被最频繁使用。

通常跟踪请求日志的信息包括请求发生的日期和时间、发出请求的用户ID或IP地址、实际请求数据以及与请求一起发送的任何头部或主体信息。

当您将请求日志用于安全目的时，以下几点值得注意：

对应用程序中受限功能或数据进行未经授权访问

在后端收到无效API密钥的情况下

记录每次登录失败尝试，以便找出任何模式

记录所有在请求中发送的无效输入参数

这些可能揭示后端应用程序中存在需要调查的弱点。另一方面，通过请求日志还可以帮助您确定应用程序最常被谁使用以及什么时间段。当您拥有这些信息时，就可以建议何时增加或缩减资源。
