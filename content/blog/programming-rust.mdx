---
title: "Programming Rust 笔记"
date: "2023-05-29"
description: "kanikani"
image: /images/blog/kaf-city.jpg
authors:
  - KUD
---

这本书已经是四年前的产物了。但是因为有中文翻译，所以我觉得看它会理解的更快一点

---
Rust 是一门系统编程语言。

系统编程是一种资源受限的编程。这种编程需要对每个字节和每个 CPU 时钟周期精打细算

Rust 实现上述所有承诺的关键在于所有权（ownership）、转移（move）和借用（borrow）机制造就的新型系统，而编译时检查和认真的设计又成就了 Rust 灵活的静态类型系统
- 所有权机制为每个值规划了清晰的生命期，从而让核心语言不再需要垃圾收集，同时还为管理套接口（socket）和文件勾柄（handle）等资源提供了可靠而又灵活的接口
- 转移把值从一个所有者转移给另一个所有者，
- 借用让代码可以临时使用某个值，同时又不影响其所有权

同样的所有权规则也是 Rust 值得依赖的并发模型的基础。说到互斥量（mutex）与其所要保护数据的关系，大多数语言是靠注释解决问题的。而 Rust 通过编译时检查可以发现访问被锁住的互斥量的问题。大多数语言只会告诫开发者要确保不访问已经交给其他线程的数据，Rust 却能通过检查保证你没有那么做。Rust 能够在编译时防止数据争用

如果将一个程序写得不可能在执行时导致未定义行为，那么就称这个程序为定义良好的（well defined）。如果一种语言的安全检查可以保证所有程序都定义良好，那么就称这种语言是类型安全的。

如果足够用心，用 C 或 C++ 应该也能写出定义良好的程序，但 C 和 C++ 不是类型安全的：前面的程序中没有类型错误，但出现了未定义行为。相对而言，Python 是类型安全的。Python 乐意花处理器时间来检查和处理数组索引越界的操作，方式也比 C 更友好

在 Python 中，ctype 是一个对 C 语言数据类型的封装。它允许 Python 代码访问和操作 C 语言中的数据类型，包括整数、浮点数、指针等。使用 ctype，Python 代码可以与 C 代码进行交互，并且可以使用 C 语言编写的库。这使得 Python 可以使用底层的 C 语言功能，提高程序的性能和效率。

rust 必须使用原始指针的情形。这种情况下你写的是不安全代码

---
```rust
fn gcd(mut n: u64, mut m: u64) -> u64 {
    assert!(n != 0 && m != 0);
    while m != 0 {
        if m < n {
            let t = m;
            m = n;
            n = t;
        }
        m = m % n;
    }
    n
}
```

Rust 的机器整数类型名反映了它们的大小及有无符号，比如 i32 表示有符号 32 位整数，u8 表示无符号 8 位整数（用于“字节”值）。isize 和 usize 分别表示指针大小的有符号和无符号整数，在 32 位平台是 32 位，在 64 位平台则为 64 位。Rust 还有两个浮点类型 f32 和 f64，分别是 IEEE 单精度和双精度浮点类型，类似 C 和 C++ 的 float 和 double。

4 个空格的缩进是 Rust 风格

默认情况下，一个变量被初始化之后，它的值就不能变了。但是，像前面那样在参数 n 和 m 前加上 mut（发音为 [mjut]，是 mutable 的简写）关键字，则表示可以在函数体内给它们赋值
